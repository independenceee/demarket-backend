generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "postgresql"
  url               = env("POSTGRES_PRISMA_URL")
  directUrl         = env("POSTGRES_URL_NON_POOLING")
  shadowDatabaseUrl = env("POSTGRES_URL_NON_POOLING")
}

model Account {
  id          String     @id @default(uuid())
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  policyId    String
  address     String     @unique
  email       String     @unique
  name        String
  description String
  rating      Float?     @db.Real
  cover       String
  avatar      String
  telegram    String     @db.Text
  linkedin    String     @db.Text
  twitter     String     @db.Text
  followed    Int?       @default(0)
  validate    Boolean    @default(false)
  cart        Cart?
  like        Likes[]
  followers   Follows[]  @relation("following")
  following   Follows[]  @relation("follower")
  Comments    Comments[]
}

model Follows {
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  follower    Account  @relation("follower", fields: [followerId], references: [id])
  followerId  String
  following   Account  @relation("following", fields: [followingId], references: [id])
  followingId String

  @@id([followerId, followingId])
}

model Likes {
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  accountId String
  account   Account  @relation(fields: [accountId], references: [id])
  nftId     String
  nft       Nft      @relation(fields: [nftId], references: [id])

  @@id([accountId, nftId])
}

model Comments {
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  accountId String  @db.Text
  account   Account @relation(fields: [accountId], references: [id])

  nftId String @db.Text
  nft   Nft    @relation(fields: [nftId], references: [id])

  @@id([accountId, nftId])
}

model Nft {
  id                 String        @id @default(uuid())
  createdAt          DateTime      @default(now())
  updatedAt          DateTime      @updatedAt
  validate           Boolean       @default(false)
  policyId           String        @unique
  assetName          String        @unique
  status             StatusNft?
  countOfTransaction Int?          @default(0)
  cart               CartNft[]
  NftCategory        NftCategory[]
  like               Likes[]
  Comments           Comments[]
}

model NftCategory {
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  categoryId String
  category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  nftId      String
  nft        Nft      @relation(fields: [nftId], references: [id], onDelete: Cascade)

  @@id([nftId, categoryId])
}

model Category {
  id          String        @id @default(uuid())
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  name        String
  slug        String
  NftCategory NftCategory[]
}

model CartNft {
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  cartId    String
  cart      Cart     @relation(fields: [cartId], references: [id], onDelete: Cascade)
  nftId     String
  nft       Nft      @relation(fields: [nftId], references: [id], onDelete: Cascade)

  @@id([cartId, nftId])
}

model Cart {
  id        String    @id @default(uuid())
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  accountId String    @unique
  account   Account   @relation(fields: [accountId], references: [id], onDelete: Cascade)
  nfts      CartNft[]
}

model Blog {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum StatusNft {
  SOLDOUT
  SELLING
}

model Guide {
  id          String   @id @default(uuid())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  question    String
  title       String
  description String
  imageUrl    String
  videoUrl    String
}

model Founder {
  id        String   @id @default(uuid())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  fistName  String
  lastName  String
  role      String
  company   String   @default("BLOCKALPHA")
  avatar    String   @db.Text
  telegram  String   @db.Text
  linkedin  String   @db.Text
  twitter   String   @db.Text
}

model Statistics {
  id               String   @id @default(uuid())
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  totalTransaction Int      @default(0)
  totalProduct     Int      @default(0)
  totalCollection  Int      @default(0)
  totalTrending    Int      @default(0)
  totalAuthor      Int      @default(0)
}
